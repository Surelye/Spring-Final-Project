<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" xmlns:th="http://www.thymeleaf.org">
    <title>Котировки акций</title>
    <link rel="stylesheet" href="/css/top_right.css">
</head>
<body>

<div th:switch="${fullBuyout}">
    <div th:case="${false}">
        <table style="text-align: center">
            <thead>
            <tr>
                <th scope="col">Название компании</th>
                <th scope="col">Стоимость покупки</th>
                <th scope="col">Стоимость продажи</th>
                <th scope="col">Количество доступных акций</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${stock.getQuantity() != 0}" th:each="stock : ${stocks}">
                <td th:text="${stock.getCompanyName()}">companyName</td>
                <td th:text="${#numbers.formatDecimal(stock.getPurchasePrice(), 1, 2)}">purchasePrice</td>
                <td th:text="${#numbers.formatDecimal(stock.getSellPrice(), 1, 2)}">sellPrice</td>
                <td th:text="${stock.getQuantity()}">quantity</td>
            </tr>
            </tbody>
        </table>
        <div th:switch="${isOpen}">
            <div th:case="${true}">
                <br>
                <form th:method="POST" th:action="@{/stocks/{id}/purchase(id=${account.getId()})}">
                    <label for="companyAndPrice">Акции какой компании Вы желаете приобрести?</label>
                    <select id="companyAndPrice" name="companyAndPrice"
                            onchange="calculateStockPurchasePrice(); checkEnoughBalance()">
                        <option th:if="${stock.getQuantity() != 0}" th:each="stock : ${stocks}"
                                th:value="${stock.getCompanyName()} + '|' + ${stock.getPurchasePrice()}"
                                th:text="${stock.getCompanyName()} + ' (' +
                                    ${#numbers.formatDecimal(stock.getPurchasePrice(), 1, 2)} + ')'">
                            companyNameAndStockPurchasePrice
                        </option>
                    </select>
                    <br>
                    <br>
                    <label for="amount">Какое количество акций вы желаете приобрести?</label>
                    <input type="number" min="1" name="amount" id="amount"
                           onchange="calculateStockPurchasePrice(); checkEnoughBalance()">
                    <input type="submit" value="Приобрести">
                </form>
                <p th:text="'Комиссия брокера составляет ' + ${account.getCommission()} + '% (включена в сделку).'"
                   th:value="${account.getCommission()}"></p>
                <input type="hidden" id="commission" th:value="${account.getCommission()}">
                <p id="purchase-price">Стоимость акций:</p>
                <input type="hidden" id="purchase-price-holder">
            </div>
            <div th:case="*">
                <p th:text="'В данный момент биржа закрыта. Возвращайтесь с 10 до 22 по МСК.'">alert</p>
            </div>
        </div>
    </div>
    <div th:case="*">
        <p th:text="'В данный момент акций нет.'">noStocksInfo</p>
    </div>
</div>

<p th:text="'Баланс вашего аккаунта составляет ' + ${#numbers.formatDecimal(account.getBalance(), 1, 2)} + ' рублей.'">
    balance</p>
<input type="hidden" id="balance-holder" th:value="${account.getBalance()}">
<script src="/js/calculatePurchasePrice.js"></script>
<script src="/js/checkEnoughBalance.js"></script>

<a class="top-right" href="/profile" th:text="'Перейти к профилю'">text</a>

<p class="hidden" id="message">

</body>
</html>